"use strict";require(["esri/arcgis/utils","esri/request","esri/arcgis/OAuthInfo","esri/arcgis/Portal","esri/IdentityManager","esri/geometry/Point","esri/geometry/Multipoint","esri/SpatialReference","esri/geometry/screenUtils","esri/tasks/IdentifyTask","esri/tasks/IdentifyParameters","esri/layers/LayerDrawingOptions","esri/renderers/SimpleRenderer","esri/renderers/ClassBreaksRenderer","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/Color","esri/TimeExtent","dojo/_base/connect","dojo/domReady!"],function(g,h,j,l,m,n,o,p,q,r,t,u,v,w,y,z,A,B,C,D){$(document).ready(function(){"use strict";function E(la){return la.split(" ").map(function(ma){return ma=ma.toLowerCase(),ma.charAt(0).toUpperCase()+ma.slice(1)}).join(" ")}var G="https://utility.arcgis.com/usrsvcs/servers/141efcbd82fd4c129f5b784c2bc85229/rest/services/LiveFeeds/Wildfire_Activity/MapServer",H=G+"/0/query",K="Active_Fire_Report",L=2,M="AREA_",N="PER_CONT",O="FIRE_NAME",P="START_DATE",Q="START_DATE_FORMATTED",U="INTERNALID",Z={"default":[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:15,width:15},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:55,width:55}],background:[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:55,width:55},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:65,width:65}]},_={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},da=function(){var la=this;this.observers=[],this.subscribe=function(ma){la.observers.push(ma)},this.unsubscribe=function(ma){la.observers=la.observers.filter(function(na){return na!==ma})},this.notify=function(ma){la.observers.forEach(function(na){return na(ma)})}},ea=new function aa(){var la=this;this.name="",this.extent=null,this.isInactiveFiresVisible=!1,this.affectedAreaRendererBreaks=[],this.setName=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";la.name=ma},this.setExtent=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;la.extent=ma},this.setIsInactiveFiresVisible=function(){var ma=0<arguments.length&&arguments[0]!==void 0&&arguments[0];la.isInactiveFiresVisible=ma},this.setAffectedAreaRendererBreaks=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];la.affectedAreaRendererBreaks=ma.map(function(na,oa){return 0===oa&&(na[0]=0),{breakInfo:na,isVisible:!0}})},this.setAffectedAreaRendererVisibilityByIndex=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:-1,na=arguments[1];-1!==ma&&(la.affectedAreaRendererBreaks[ma].isVisible=na)},this.getAffectedAreaRendererBreaks=function(){return la.affectedAreaRendererBreaks},this.getWhereClause=function(){var na=[N+" < 100"],oa=la.affectedAreaRendererBreaks.filter(function(sa){return!sa.isVisible}).length;if(oa){var pa=la.affectedAreaRendererBreaks.filter(function(sa){return sa.isVisible}),qa=0<pa.length?pa.map(function(sa){var ua=sa.breakInfo[0],va=sa.breakInfo[1];return"( "+M+" > "+ua+" AND "+M+" <= "+va+" )"}).join(" OR "):M+" = -1 ";na.push(qa)}if(la.name){var ra=O+" = '"+la.name+"'";na.push(ra)}return na=na.map(function(sa){return"("+sa+")"}),na.join(" AND ")},this.getQueryParams=function(){var ma=0<arguments.length&&arguments[0]!==void 0&&arguments[0],na=la.getWhereClause(),oa={f:"json",outFields:"*",where:na,returnGeometry:ma};if(la.extent){var pa=JSON.stringify(la.extent.toJson());oa.geometry=pa,oa.geometryType="esriGeometryEnvelope"}return oa},this.getRendererBreakIndex=function(ma){ma=+ma;var na=-1;return la.affectedAreaRendererBreaks.forEach(function(oa,pa){var qa=oa.breakInfo[1],ra=oa.breakInfo[0];ma>ra&&ma<=qa&&(na=pa)}),na}},fa=new function ba(){var pa=this;this.map=null,this.identifyTask=null,this.identifyParams=null,this.operationalLayers=[],this.allWildfires=[],this.allWildfiresLookupTable={},this.allWildfiresPerimeterLookupTable={},this.wildfireClassBreakRendererInfo=null,this.smokeLayerTimeInfo=null;var la=null,ma=null,na=null;this.startUp=function(){var qa=this;this.generateClassBreakRendererInfo(M,function(ra){qa.setWildfireClassBreakRendererInfo(ra),qa._initWebMapByID("108e2e8b36ef47abb3942b00e8d69128")})},this.setMap=function(qa){this.map=qa},this.setSmokeLayerTimeInfo=function(qa){this.smokeLayerTimeInfo=qa},this.setAllWildfires=function(qa){this.allWildfires=qa.map(function(ra){var sa=moment(ra.attributes[P]).format("MMMM Do, YYYY");return ra.attributes[Q]=sa,ra}),this.setAllWildfiresLookupTable()},this.setAllWildfiresLookupTable=function(){var ra={};this.allWildfires.forEach(function(sa){var ta=sa.attributes[U];ra[ta]=sa}),this.allWildfiresLookupTable=ra},this.setAllWildfiresPerimeterLookupTable=function(qa){var ra=this;qa.forEach(function(sa){var ta=sa.attributes.FIRE_NAME.toLowerCase();ra.allWildfiresPerimeterLookupTable[ta]=sa.attributes})},this.getFirePerimeterDataByName=function(qa){return qa=qa.toLowerCase(),this.allWildfiresPerimeterLookupTable[qa]},this.getFireDataByID=function(qa){return this.allWildfiresLookupTable[qa]},this.setOperationalLayers=function(qa){var ra=this._getWebMapOperationalLayers(qa),sa=ra.filter(function(ua){return-1!==ua.title.indexOf("Active_Fire")}),ta=sa[0].layerObject.layerDrawingOptions[0].renderer.breaks;this.operationalLayers=ra,ea.setAffectedAreaRendererBreaks(ta),ga.setFilterLabel(ta)},this._initWebMapByID=function(qa){var ra=this;g.createMap(qa,"mapDiv").then(function(sa){var ta=sa.map;D.disconnect(sa.clickEventHandle),ra.setMap(ta),ra.setMapEeventHandlers(ta),ra.setIdentifyTaskAndParams(ta),ra.setOperationalLayers(sa),ra.mapOnReadyHandler()})},this.mapOnReadyHandler=function(){var ra=this,qa=ea.getQueryParams(!0);this._queryWildfireData(H,qa,function(sa){ra.setAllWildfires(sa),ra.zoomToExtentOfAllFires()}),this._queryWildfireData(G+"/2/query",{f:"json",where:"1=1",outFields:"*",returnGeometry:!1},function(sa){ra.setAllWildfiresPerimeterLookupTable(sa)})},this.searchWildfire=function(){var ua=this,qa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ra=arguments[1],sa=ea.getQueryParams();ra=ra||function ta(va){var wa=ua.sortFiresByFieldName(va,M);ga.populateWildfires(wa),ua._setLayerDefinitionsForWildfireLayer(sa.where,wa)},this._queryWildfireData(H,sa,ra)},this.sortFiresByFieldName=function(qa,ra){var sa=qa;return sa.sort(function(ta,ua){return+ua.attributes[ra]-+ta.attributes[ra]}),sa},this.setWildfireClassBreakRendererInfo=function(qa){this.wildfireClassBreakRendererInfo=qa},this.getListOfFires=function(qa){var ra=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",sa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",ta=this.allWildfires;return ra&&(ta=ta.filter(function(ua){return ua.attributes[ra]===sa})),qa&&(ta=ta.map(function(ua){return ua.attributes[O]})),ta},this.getMatchedFireNames=function(){var qa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",ra=pa.getListOfFires(!0),sa=new RegExp("^"+qa+".*$","i"),ta=[];return 2<=qa.length&&(ta=ra.filter(function(ua){return ua.match(sa)}).splice(0,5)),ta},this.getFireIdByName=function(qa){var ra=this.getListOfFires(!1,O,qa)[0];return ra?ra.attributes[U]:""},this.showInfoWindow=function(){var qa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",ra=this.getFireDataByID(qa),sa=this.getFeatureGeometryInWgs84(ra),ta=this.convertGeomToScreenPoint(sa),ua=ra.attributes["STATE"],va=_[ua]?_[ua]:ua,wa=+ra.attributes["LATITUDE"].toFixed(2),xa=+ra.attributes["LONGITUDE"].toFixed(2),ya=ra.attributes[O].toLowerCase()+" fire",Ba=this.getFirePerimeterDataByName(ra.attributes[O]),Ca=Ba?Ba["LOAD_DATE"]:null,Da=Ca?ja(Ca):null,Ea="\n                    <div class='customized-popup-header'>\n                        <span class='font-size--3'>Start Date: "+ra.attributes[Q]+"</span>\n                        <span class='js-close-info-window icon-ui-close avenir-bold cursor-pointer font-size--3 right'></span>\n                    </div>\n                    <div class='leader-quarter trailer-quarter'>\n                        <p class='trailer-quarter'> \n                            The "+ra.attributes[O]+" fire is estimated to be "+ia(ra.attributes[M])+" acres and <strong>"+ra.attributes[N]+"%</strong> contained.\n                        </p>\n                        "+(Da?"<p class=\"trailer-quarter\">Fire perimeter updated "+Da+" ago.</p>":"")+"\n                        <p class='font-size--3 trailer-quarter'>\n                            "+va+" ("+wa+", "+xa+")\n                        </p>\n                        <hr>\n                        <div class='info-window-links'>\n                            <a href='"+("https://news.google.com/search?q="+ya)+"' target='_blank' class=''>News</a>\n                            <a href='"+("https://twitter.com/search?q="+ya)+"' target='_blank' class='margin-left-half'>Twitter</a>\n                        </div>\n                    <div>\n                ";this.map.infoWindow.setContent(Ea),this.map.infoWindow.show(sa),ga.setSquareReferenceBoxPosition(ta)},this.hideInforWindow=function(){this.map.infoWindow.hide(),ga.setSquareReferenceBoxPosition(null)},this.zoomToFire=function(){var qa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",ra=this.getFireDataByID(qa),sa=this.getFeatureGeometryInWgs84(ra);this.map.centerAndZoom(sa,12)},this._queryWildfireData=function(qa,ra,sa){var va=h({url:qa,content:ra,handleAs:"json",callbackParamName:"callback"});va.then(function(wa){sa(wa.features)},function(wa){console.log("Error: ",wa.message)})},this.getDefExpForFirePerimeterLayer=function(){var qa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],ra=qa.length?qa.map(function(sa){var ta=sa.attributes[O].replace("'"," ");return O+" = '"+ta+"'"}).join(" OR "):O+" = ''";return ra},this._setLayerDefinitionsForWildfireLayer=function(qa,ra){var ta=this,sa=[qa];this.operationalLayers.forEach(function(ua){if(-1!==ua.id.indexOf("Wildfire")){if(ua.title===K){var va=ta.getDefExpForFirePerimeterLayer(ra);sa[L]=va}ua.layerObject.setLayerDefinitions(sa)}})},this._getWebMapOperationalLayers=function(qa){var sa=this,ra=qa.itemInfo.itemData.operationalLayers.filter(function(ta){return"ArcGISMapServiceLayer"===ta.layerType});return ra.forEach(function(ta){-1!==ta.title.indexOf("Active_Fire")&&sa.setLayerDrawingOptions(ta),-1!==ta.title.indexOf("SmokeForecast")&&(sa.setCssStyleForSmokeLayerContainer(ta.id),sa.setSmokeLayerTimeInfo(ta.layerObject.timeInfo))}),ra},this.setCssStyleForSmokeLayerContainer=function(qa){var ra=$("#mapDiv_"+qa);ra.css("filter","invert(100%) blur(5px) saturate(.4)")},this.setMapExtent=function(qa,ra){qa=qa?new Date(qa):this.smokeLayerTimeInfo.timeExtent.startTime,ra=ra?new Date(ra):qa;var sa=new C;sa.startTime=qa,sa.endTime=ra,this.map.setTimeExtent(sa)},this.toggleSmokeLayer=function(){var qa=this.operationalLayers.filter(function(sa){return-1!==sa.title.indexOf("SmokeForecast")})[0],ra=!qa.layerObject.visible;ra?(this.animateSmokeLayer(),qa.layerObject.show()):(clearInterval(la),qa.layerObject.hide(),ga.updateSmokeLayerTimeVal(null))},this.animateSmokeLayer=function(){var qa=this;la=setInterval(function(){ma?(ma=new Date(ma),ma=ma.setHours(ma.getHours()+1),ma>na&&(ma=qa.smokeLayerTimeInfo.timeExtent.startTime)):(ma=qa.smokeLayerTimeInfo.timeExtent.startTime,na=new Date(ma),na=na.setHours(ma.getHours()+24));var ra=Math.abs(ma-qa.smokeLayerTimeInfo.timeExtent.startTime.getTime())/3.6e6;qa.setMapExtent(ma),ga.updateSmokeLayerTimeVal(ra)},750)},this.getWildfireLayerRendererByTitle=function(qa){var ra=JSON.parse(JSON.stringify(this.wildfireClassBreakRendererInfo)),sa=qa===K?Z["default"]:Z.background;return ra.classBreakInfos=ra.classBreakInfos.map(function(ta,ua){var va=new y(sa[ua]);return ta.symbol=va.toJson(),ta}),new w(ra)},this.getRendererForFirePerimeter=function(){var qa=new z(z.STYLE_SOLID,new A(A.STYLE_SOLID,new B([103,0,67,0.9]),1),new B([103,0,67,0.4])),ra=new v(qa);return ra},this.setLayerDrawingOptions=function(qa){var ra=qa.layerObject,sa=qa.title,ta=sa===K?.75:.5,ua=[],va=this.getLayerDrawingOption(sa);if(ua[0]=va,sa===K){var wa=this.getLayerDrawingOption(sa,L);ua[L]=wa}ra.setLayerDrawingOptions(ua),ra.setOpacity(ta)},this.getLayerDrawingOption=function(qa){var ra=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,sa=new u;return sa.renderer=0===ra?pa.getWildfireLayerRendererByTitle(qa):pa.getRendererForFirePerimeter(),sa},this.zoomToExtentOfAllFires=function(){var qa=this.allWildfires.map(function(sa){return[sa.geometry.x,sa.geometry.y]}),ra=new o(new p({wkid:102100}));ra.points=qa,this.map.setExtent(ra.getExtent(),!0)},this.execIdentifyTask=function(qa){var ra=this.identifyTaskOnSuccessHandler;this.identifyParams.geometry=qa,this.identifyParams.mapExtent=this.map.extent,this.identifyTask.execute(this.identifyParams,ra)},this.identifyTaskOnSuccessHandler=function(qa){if(qa.length){var ra=qa[0].value,sa=pa.getFireIdByName(ra);pa.showInfoWindow(sa)}},this.setIdentifyTaskAndParams=function(qa){var ra=new t;ra.tolerance=8,ra.returnGeometry=!1,ra.layerIds=[0],ra.width=qa.width,ra.height=qa.height,this.identifyParams=ra,this.identifyTask=new r(G)},this.setMapEeventHandlers=function(qa){var ra=this;qa.on("click",function(sa){ra.hideInforWindow(),ra.execIdentifyTask(sa.mapPoint)}),qa.on("extent-change",function(sa){var ta=qa.getZoom();ra.hideInforWindow(),13>ta&&(ea.setExtent(sa.extent),ra.searchWildfire())})},this.generateClassBreakRendererInfo=function(qa,ra){var ua={classificationDef:JSON.stringify({type:"classBreaksDef",classificationField:qa,classificationMethod:"esriClassifyNaturalBreaks",breakCount:5}),layer:JSON.stringify({source:{type:"mapLayer",mapLayerId:0}}),f:"json",where:""},va=h({url:G+"/dynamicLayer/generateRenderer",content:ua,handleAs:"json"});va.then(function(wa){ra(wa)},function(wa){console.log("Error: ",wa.message)})},this.getFeatureGeometryInWgs84=function(qa){return new n({x:qa.attributes.LONGITUDE,y:qa.attributes.LATITUDE,spatialReference:{wkid:4326}})},this.convertGeomToScreenPoint=function(qa){var ra=q.toScreenPoint(pa.map.extent,pa.map.width,pa.map.height,qa);return ra},this.startUp()},ga=new function ca(){var la=$(".val-holder-num-of-fires"),ma=$(".val-holder-smoke-layer-time"),na=$(".fire-name-search-input"),oa=$(".square-reference-box");this.wildfireGrids=null,this.wildfireTimeline=null,this.fireNameDropdownMenu=null,this.fireDataOberver=null,this.fireSummaryInfoVisibilityOberver=null,this.init=function(){this.wildfireGrids=new qa("wildfire-grid-container"),this.wildfireTimeline=new pa("wildfire-timeline-container"),this.fireNameDropdownMenu=new ra("fire-name-dropdown-menu"),this.initFireDataObserser(),this.initFireSummaryInfoVisibilityOberver()},this.initFireDataObserser=function(){this.fireDataOberver=new da,this.fireDataOberver.subscribe(this.wildfireGrids.populate),this.fireDataOberver.subscribe(this.wildfireTimeline.populate),this.fireDataOberver.subscribe(this.updateNumOfFiresVal)},this.populateWildfires=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];this.fireDataOberver.notify(ta)},this.updateNumOfFiresVal=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];la.text(ta.length)},this.updateSmokeLayerTimeVal=function(ta){var ua=Number.isInteger(ta)?" (+"+ta+" hr)":"";ma.text(ua)},this.initFireSummaryInfoVisibilityOberver=function(){this.fireSummaryInfoVisibilityOberver=new da,this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireGrids.toggle),this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireTimeline.toggle)},this.toggleFireSummaryInfo=function(ta){this.fireSummaryInfoVisibilityOberver.notify(ta)},this.setFilterLabel=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];ta.forEach(function(ua,va){var wa=ha(+ua[1]),xa=$(".filter-wrap[data-filter-index=\""+va+"\"]").find(".filter-label");xa.text(wa)})},this.setSquareReferenceBoxPosition=function(ta){if(!ta)oa.addClass("hide");else{var ua=oa.width()/2;oa.css("top",ta.y-ua),oa.css("left",ta.x-ua),oa.removeClass("hide")}};var pa=function(ta){var ua=$("#"+ta),va=function(){var xa=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],ya={},za=[];return xa.sort(function(Aa,Ba){return Ba.attributes[P]-Aa.attributes[P]}),xa.forEach(function(Aa){var Ba=Aa.attributes[P];ya[Ba]?ya[Ba].fires.push(Aa):(ya[Ba]={startDate:Ba,fires:[Aa],isFirstItemInMonth:!1},za.push(Ba))}),xa=za.map(function(Aa,Ba){var Ca=za[Ba-1],Da=wa(Aa,Ca);return Da&&(ya[Aa].isFirstItemInMonth=!0),ya[Aa]}),xa},wa=function(xa,ya){return xa=new Date(xa),ya=new Date(ya),xa&&ya&&xa.getMonth()!==ya.getMonth()};this.toggle=function(xa){xa===ta?ua.removeClass("hide"):ua.addClass("hide")},this.populate=function(){var xa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];xa=va(xa);var ya=xa.map(function(za){var Ba=moment(za.startDate).format("MMM Do"),Ca=moment(za.startDate).format("MMMM"),Ea=za.fires.map(function(Ga){var Ha=Ga.attributes[N],Ia=Ga.attributes[O],Ja=Ga.attributes[M],Ka=ea.getRendererBreakIndex(Ja),La=Ga.attributes[U],Ma="\n                                <div class='trailer-1 fire-info'>\n                                    <div class='inline-block font-size--3 padding-left-half margin-right-half'><span class='cursor-pointer js-show-info-window js-zoom-to-fire' data-fire-id=\""+La+"\"><strong>"+E(Ia)+" Fire</strong>  - "+Ha+"% contained</span></div>\n                                    <div class=\"legend-icon legend-class-"+Ka+"\"></div>\n                                </div>\n                            ";return Ma}).join(""),Fa="\n                            "+(za.isFirstItemInMonth?"\n                            <div class='timeline-month-title text-center'>\n                                <div class='padding-leader-quarter padding-trailer-quarter '>\n                                    <span class'avenir-bold'>"+Ca+"</span>\n                                </div>\n                            </div>\n                        ":"")+"\n                            <div class='timeline-item'>\n                                <div class='date-info font-size--2'>"+Ba+"</div>\n                                <div class='fire-info-wrap text-right'>\n                                    "+Ea+"\n                                </div>\n                            </div>\n                        ";return Fa}).join("");ua.html(ya)}},qa=function(ta){var ua=$("#"+ta);this.toggle=function(va){va===ta?ua.removeClass("hide"):ua.addClass("hide")},this.populate=function(){var va=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],wa=va.map(function(xa){var ya=xa.attributes[N],za=xa.attributes[O],Aa=xa.attributes[M],Ba=ea.getRendererBreakIndex(Aa),Ca=xa.attributes[U];return"\n                            <div class=\"js-show-info-window block trailer-half js-zoom-to-fire\" data-fire-id=\""+Ca+"\">\n                                <div class=\"legend-icon legend-class-"+Ba+"\">\n                                    <div class='bottom-pct-indicator'>\n                                        <div class='highlight-bar' style=\"width: "+ya+"%;\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        "}).join("");ua.html(wa)}},ra=function(ta){var wa=this,ua=$("#"+ta),va=ua.parent();this.populate=function(xa){xa=xa||fa.getListOfFires(!0);var ya=xa.map(function(za){return"<div class='suggestion-item js-set-suggested-item' data-fire-name=\""+za+"\"><span class='font-size--2'>"+za+"</span></div>"}).join("");ua.html(ya)},this.getCountOfDropdownMenuItems=function(){return ua.children().length},this.show=function(){ua.removeClass("hide"),wa.toggleIsDropdownVisible(!0)},this.hide=function(){ua.addClass("hide"),wa.toggleIsDropdownVisible(!1)},this.toggleDropdownMenu=function(){ua.toggleClass("hide");var xa=!ua.hasClass("hide"),ya=!!wa.getCountOfDropdownMenuItems();xa&&!ya&&wa.populate(),wa.toggleIsDropdownVisible(xa)},this.setSelectedItem=function(){var xa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";va.find(".fire-name-search-input").val(xa);wa.toggleIsSearchInputFilled(!!xa),wa.hide(),ea.setName(xa),fa.searchWildfire()},this.toggleIsDropdownVisible=function(xa){xa?va.addClass("is-dropdown-menu-visible"):va.removeClass("is-dropdown-menu-visible")},this.toggleIsSearchInputFilled=function(){var xa=0<arguments.length&&arguments[0]!==void 0&&arguments[0];xa?va.addClass("is-search-input-filled"):va.removeClass("is-search-input-filled")}},sa=function(){var ta=$("body");ta.on("click",".js-zoom-to-fire",function(){var ua=$(this).attr("data-fire-id");fa.zoomToFire(ua)}),ta.on("mouseenter",".js-show-info-window",function(){var ua=$(this).attr("data-fire-id");fa.showInfoWindow(ua)}),ta.on("mouseleave",".js-show-info-window",function(){fa.hideInforWindow()}),ta.on("click",".js-close-info-window",function(){fa.hideInforWindow()}),ta.on("click",".js-toggle-fire-summary-info-container",function(){var ua=$(this),va=ua.attr("data-target-container");ua.siblings().removeClass("is-active"),ua.addClass("is-active"),ga.toggleFireSummaryInfo(va)}),ta.on("click",".toggle-suggestion-list-btn",function(){ga.fireNameDropdownMenu.toggleDropdownMenu()}),ta.on("click",".js-set-suggested-item",function(){var ua=$(this).attr("data-fire-name");ga.fireNameDropdownMenu.setSelectedItem(ua)}),ta.on("click",".js-clear-suggested-item",function(){ga.fireNameDropdownMenu.setSelectedItem(null),ga.fireNameDropdownMenu.populate()}),na.on("keyup",function(){var ua=$(this).val(),va=fa.getMatchedFireNames(ua);ga.fireNameDropdownMenu.populate(va),ua?ga.fireNameDropdownMenu.toggleIsSearchInputFilled(!0):ga.fireNameDropdownMenu.toggleIsSearchInputFilled(!1),va.length?ga.fireNameDropdownMenu.show():ga.fireNameDropdownMenu.hide()}),ta.on("click",".js-toggle-smoke-layer",function(){$(".smoke-layer-toggle-btn").toggleClass("checked"),fa.toggleSmokeLayer()})}();this.init()},ha=function(la,ma){if(null===la)return null;if(0===la)return"0";ma=!ma||0>ma?0:ma,ma=1e4<la?0:1;var na=la.toPrecision(2).split("e"),oa=1===na.length?0:Math.floor(Math.min(na[1].slice(1),14)/3),pa=1>oa?la.toFixed(0+ma):(la/Math.pow(10,3*oa)).toFixed(ma),qa=0>pa?pa:Math.abs(pa),ra=qa+["","K","M","B","T"][oa];return ra},ia=function(la){return la.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},ja=function(la){var ma=ka(la),na="";return na=24>ma?ma.toFixed(0)+" hours":Math.floor(ma/24)+" days",na},ka=function(la){la=new Date(la).getTime();var ma=new Date().getTime(),na=Math.abs(la-ma)/36e5;return na}})}),console.log("Love the app? The source code is available on GitHub:","https://github.com/vannizhang/wildfire-viz-app");