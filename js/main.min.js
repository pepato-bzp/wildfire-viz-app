"use strict";require(["esri/arcgis/utils","esri/request","esri/arcgis/OAuthInfo","esri/arcgis/Portal","esri/IdentityManager","esri/geometry/Point","esri/geometry/Multipoint","esri/SpatialReference","esri/geometry/screenUtils","esri/tasks/IdentifyTask","esri/tasks/IdentifyParameters","esri/layers/LayerDrawingOptions","esri/renderers/SimpleRenderer","esri/renderers/ClassBreaksRenderer","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/Color","esri/TimeExtent","dojo/_base/connect","dojo/domReady!"],function(g,h,j,l,m,n,o,p,q,r,t,u,v,w,y,z,A,B,C,D){$(document).ready(function(){"use strict";function E(ha){return ha.split(" ").map(function(ia){return ia=ia.toLowerCase(),ia.charAt(0).toUpperCase()+ia.slice(1)}).join(" ")}var G="https://utility.arcgis.com/usrsvcs/servers/141efcbd82fd4c129f5b784c2bc85229/rest/services/LiveFeeds/Wildfire_Activity/MapServer",J="Active_Fire_Report",K=2,L="AREA_",M="PER_CONT",N="FIRE_NAME",O="START_DATE",P="START_DATE_FORMATTED",T="INTERNALID",X={"default":[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:15,width:15},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:55,width:55}],background:[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:55,width:55},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:65,width:65}]},Y={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},ba=function(){var ha=this;this.observers=[],this.subscribe=function(ia){ha.observers.push(ia)},this.unsubscribe=function(ia){ha.observers=ha.observers.filter(function(ja){return ja!==ia})},this.notify=function(ia){ha.observers.forEach(function(ja){return ja(ia)})}},ca=new function Z(){var ha=this;this.name="",this.extent=null,this.isInactiveFiresVisible=!1,this.affectedAreaRendererBreaks=[],this.setName=function(){var ia=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";ha.name=ia},this.setExtent=function(){var ia=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;ha.extent=ia},this.setIsInactiveFiresVisible=function(){var ia=0<arguments.length&&arguments[0]!==void 0&&arguments[0];ha.isInactiveFiresVisible=ia},this.setAffectedAreaRendererBreaks=function(){var ia=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];ha.affectedAreaRendererBreaks=ia.map(function(ja,ka){return 0===ka&&(ja[0]=0),{breakInfo:ja,isVisible:!0}})},this.setAffectedAreaRendererVisibilityByIndex=function(){var ia=0<arguments.length&&arguments[0]!==void 0?arguments[0]:-1,ja=arguments[1];-1!==ia&&(ha.affectedAreaRendererBreaks[ia].isVisible=ja)},this.getAffectedAreaRendererBreaks=function(){return ha.affectedAreaRendererBreaks},this.getWhereClause=function(){var ja=[M+" < 100"],ka=ha.affectedAreaRendererBreaks.filter(function(oa){return!oa.isVisible}).length;if(ka){var la=ha.affectedAreaRendererBreaks.filter(function(oa){return oa.isVisible}),ma=0<la.length?la.map(function(oa){var qa=oa.breakInfo[0],ra=oa.breakInfo[1];return"( "+L+" > "+qa+" AND "+L+" <= "+ra+" )"}).join(" OR "):L+" = -1 ";ja.push(ma)}if(ha.name){var na=N+" = '"+ha.name+"'";ja.push(na)}return ja=ja.map(function(oa){return"("+oa+")"}),ja.join(" AND ")},this.getQueryParams=function(){var ia=0<arguments.length&&arguments[0]!==void 0&&arguments[0],ja=ha.getWhereClause(),ka={f:"json",outFields:"*",where:ja,returnGeometry:ia};if(ha.extent){var la=JSON.stringify(ha.extent.toJson());ka.geometry=la,ka.geometryType="esriGeometryEnvelope"}return ka},this.getRendererBreakIndex=function(ia){ia=+ia;var ja=-1;return ha.affectedAreaRendererBreaks.forEach(function(ka,la){var ma=ka.breakInfo[1],na=ka.breakInfo[0];ia>na&&ia<=ma&&(ja=la)}),ja}},da=new function _(){var la=this;this.map=null,this.identifyTask=null,this.identifyParams=null,this.operationalLayers=[],this.allWildfires=[],this.allWildfiresLookupTable={},this.wildfireClassBreakRendererInfo=null,this.smokeLayerTimeInfo=null;var ha=null,ia=null,ja=null;this.startUp=function(){var ma=this;this.generateClassBreakRendererInfo(L,function(na){ma.setWildfireClassBreakRendererInfo(na),ma._initWebMapByID("de31c65a5641422ba9ced5b234ba6e02")})},this.setMap=function(ma){this.map=ma},this.setSmokeLayerTimeInfo=function(ma){this.smokeLayerTimeInfo=ma},this.setAllWildfires=function(ma){this.allWildfires=ma.map(function(na){var oa=moment(na.attributes[O]).format("MMMM Do, YYYY");return na.attributes[P]=oa,na}),this.setAllWildfiresLookupTable()},this.setAllWildfiresLookupTable=function(){var na={};this.allWildfires.forEach(function(oa){var pa=oa.attributes[T];na[pa]=oa}),this.allWildfiresLookupTable=na},this.getFireDataByID=function(ma){return this.allWildfiresLookupTable[ma]},this.setOperationalLayers=function(ma){var na=this._getWebMapOperationalLayers(ma),oa=na.filter(function(qa){return-1!==qa.title.indexOf("Active_Fire")}),pa=oa[0].layerObject.layerDrawingOptions[0].renderer.breaks;this.operationalLayers=na,ca.setAffectedAreaRendererBreaks(pa),ea.setFilterLabel(pa)},this._initWebMapByID=function(ma){var na=this;g.createMap(ma,"mapDiv").then(function(oa){var pa=oa.map;D.disconnect(oa.clickEventHandle),na.setMap(pa),na.setMapEeventHandlers(pa),na.setIdentifyTaskAndParams(pa),na.setOperationalLayers(oa),na.mapOnReadyHandler()})},this.mapOnReadyHandler=function(){var na=this,ma=ca.getQueryParams(!0);this._queryWildfireData(ma,function(oa){na.setAllWildfires(oa),na.zoomToExtentOfAllFires()})},this.searchWildfire=function(){var qa=this,ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},na=arguments[1],oa=ca.getQueryParams();na=na||function pa(ra){var sa=qa.sortFiresByFieldName(ra,L);ea.populateWildfires(sa),qa._setLayerDefinitionsForWildfireLayer(oa.where,sa)},this._queryWildfireData(oa,na)},this.sortFiresByFieldName=function(ma,na){var oa=ma;return oa.sort(function(pa,qa){return+qa.attributes[na]-+pa.attributes[na]}),oa},this.setWildfireClassBreakRendererInfo=function(ma){this.wildfireClassBreakRendererInfo=ma},this.getListOfFires=function(ma){var na=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",oa=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",pa=this.allWildfires;return na&&(pa=pa.filter(function(qa){return qa.attributes[na]===oa})),ma&&(pa=pa.map(function(qa){return qa.attributes[N]})),pa},this.getMatchedFireNames=function(){var ma=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",na=la.getListOfFires(!0),oa=new RegExp("^"+ma+".*$","i"),pa=[];return 2<=ma.length&&(pa=na.filter(function(qa){return qa.match(oa)}).splice(0,5)),pa},this.getFireIdByName=function(ma){var na=this.getListOfFires(!1,N,ma)[0];return na?na.attributes[T]:""},this.showInfoWindow=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",na=this.getFireDataByID(ma),oa=this.getFeatureGeometryInWgs84(na),pa=this.convertGeomToScreenPoint(oa),qa=na.attributes["STATE"],ra=Y[qa]?Y[qa]:qa,sa=+na.attributes["LATITUDE"].toFixed(2),ta=+na.attributes["LONGITUDE"].toFixed(2),ua=na.attributes[N].toLowerCase()+" fire",xa="\n                    <div class='customized-popup-header'>\n                        <span class='font-size--3'>Start Date: "+na.attributes[P]+"</span>\n                        <span class='js-close-info-window icon-ui-close avenir-bold cursor-pointer font-size--3 right'></span>\n                    </div>\n                    <div class='leader-quarter trailer-quarter'>\n                        <p class='trailer-quarter'> \n                            The "+na.attributes[N]+" fire is estimated to be "+ga(na.attributes[L])+" acres and <strong>"+na.attributes[M]+"%</strong> contained.\n                        </p>\n                        <p class='font-size--3 trailer-quarter'>\n                            "+ra+" ("+sa+", "+ta+")\n                        </p>\n                        <hr>\n                        <div class='info-window-links'>\n                            <a href='"+("https://news.google.com/search?q="+ua)+"' target='_blank' class=''>News</a>\n                            <a href='"+("https://twitter.com/search?q="+ua)+"' target='_blank' class='margin-left-half'>Twitter</a>\n                        </div>\n                    <div>\n                ";this.map.infoWindow.setContent(xa),this.map.infoWindow.show(oa),ea.setSquareReferenceBoxPosition(pa)},this.hideInforWindow=function(){this.map.infoWindow.hide(),ea.setSquareReferenceBoxPosition(null)},this.zoomToFire=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",na=this.getFireDataByID(ma),oa=this.getFeatureGeometryInWgs84(na);this.map.centerAndZoom(oa,12)},this._queryWildfireData=function(ma,na){var qa=h({url:G+"/0/query",content:ma,handleAs:"json",callbackParamName:"callback"});qa.then(function(ra){na(ra.features)},function(ra){console.log("Error: ",ra.message)})},this.getDefExpForFirePerimeterLayer=function(){var ma=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],na=ma.length?ma.map(function(oa){var pa=oa.attributes[N].replace("'"," ");return N+" = '"+pa+"'"}).join(" OR "):N+" = ''";return na},this._setLayerDefinitionsForWildfireLayer=function(ma,na){var pa=this,oa=[ma];this.operationalLayers.forEach(function(qa){if(-1!==qa.id.indexOf("Wildfire")){if(qa.title===J){var ra=pa.getDefExpForFirePerimeterLayer(na);oa[K]=ra}qa.layerObject.setLayerDefinitions(oa)}})},this._getWebMapOperationalLayers=function(ma){var oa=this,na=ma.itemInfo.itemData.operationalLayers.filter(function(pa){return"ArcGISMapServiceLayer"===pa.layerType});return na.forEach(function(pa){-1!==pa.title.indexOf("Active_Fire")&&oa.setLayerDrawingOptions(pa),-1!==pa.title.indexOf("SmokeForecast")&&(oa.setCssStyleForSmokeLayerContainer(pa.id),oa.setSmokeLayerTimeInfo(pa.layerObject.timeInfo))}),na},this.setCssStyleForSmokeLayerContainer=function(ma){var na=$("#mapDiv_"+ma);na.css("filter","invert(100%) blur(5px) saturate(.4)")},this.setMapExtent=function(ma,na){ma=ma?new Date(ma):this.smokeLayerTimeInfo.timeExtent.startTime,na=na?new Date(na):ma;var oa=new C;oa.startTime=ma,oa.endTime=na,this.map.setTimeExtent(oa)},this.toggleSmokeLayer=function(){var ma=this.operationalLayers.filter(function(oa){return-1!==oa.title.indexOf("SmokeForecast")})[0],na=!ma.layerObject.visible;na?(this.animateSmokeLayer(),ma.layerObject.show()):(clearInterval(ha),ma.layerObject.hide(),ea.updateSmokeLayerTimeVal(null))},this.animateSmokeLayer=function(){var ma=this;ha=setInterval(function(){ia?(ia=new Date(ia),ia=ia.setHours(ia.getHours()+1),ia>ja&&(ia=ma.smokeLayerTimeInfo.timeExtent.startTime)):(ia=ma.smokeLayerTimeInfo.timeExtent.startTime,ja=new Date(ia),ja=ja.setHours(ia.getHours()+24));var na=Math.abs(ia-ma.smokeLayerTimeInfo.timeExtent.startTime.getTime())/3.6e6;ma.setMapExtent(ia),ea.updateSmokeLayerTimeVal(na)},750)},this.getWildfireLayerRendererByTitle=function(ma){var na=JSON.parse(JSON.stringify(this.wildfireClassBreakRendererInfo)),oa=ma===J?X["default"]:X.background;return na.classBreakInfos=na.classBreakInfos.map(function(pa,qa){var ra=new y(oa[qa]);return pa.symbol=ra.toJson(),pa}),new w(na)},this.getRendererForFirePerimeter=function(){var ma=new z(z.STYLE_SOLID,new A(A.STYLE_SOLID,new B([103,0,67,0.9]),1),new B([103,0,67,0.4])),na=new v(ma);return na},this.setLayerDrawingOptions=function(ma){var na=ma.layerObject,oa=ma.title,pa=oa===J?.75:.5,qa=[],ra=this.getLayerDrawingOption(oa);if(qa[0]=ra,oa===J){var sa=this.getLayerDrawingOption(oa,K);qa[K]=sa}na.setLayerDrawingOptions(qa),na.setOpacity(pa)},this.getLayerDrawingOption=function(ma){var na=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,oa=new u;return oa.renderer=0===na?la.getWildfireLayerRendererByTitle(ma):la.getRendererForFirePerimeter(),oa},this.zoomToExtentOfAllFires=function(){var ma=this.allWildfires.map(function(oa){return[oa.geometry.x,oa.geometry.y]}),na=new o(new p({wkid:102100}));na.points=ma,this.map.setExtent(na.getExtent(),!0)},this.execIdentifyTask=function(ma){var na=this.identifyTaskOnSuccessHandler;this.identifyParams.geometry=ma,this.identifyParams.mapExtent=this.map.extent,this.identifyTask.execute(this.identifyParams,na)},this.identifyTaskOnSuccessHandler=function(ma){if(ma.length){var na=ma[0].value,oa=la.getFireIdByName(na);la.showInfoWindow(oa)}},this.setIdentifyTaskAndParams=function(ma){var na=new t;na.tolerance=8,na.returnGeometry=!1,na.layerIds=[0],na.width=ma.width,na.height=ma.height,this.identifyParams=na,this.identifyTask=new r(G)},this.setMapEeventHandlers=function(ma){var na=this;ma.on("click",function(oa){na.hideInforWindow(),na.execIdentifyTask(oa.mapPoint)}),ma.on("extent-change",function(oa){var pa=ma.getZoom();na.hideInforWindow(),13>pa&&(ca.setExtent(oa.extent),na.searchWildfire())})},this.generateClassBreakRendererInfo=function(ma,na){var qa={classificationDef:JSON.stringify({type:"classBreaksDef",classificationField:ma,classificationMethod:"esriClassifyNaturalBreaks",breakCount:5}),layer:JSON.stringify({source:{type:"mapLayer",mapLayerId:0}}),f:"json",where:""},ra=h({url:G+"/dynamicLayer/generateRenderer",content:qa,handleAs:"json"});ra.then(function(sa){na(sa)},function(sa){console.log("Error: ",sa.message)})},this.getFeatureGeometryInWgs84=function(ma){return new n({x:ma.attributes.LONGITUDE,y:ma.attributes.LATITUDE,spatialReference:{wkid:4326}})},this.convertGeomToScreenPoint=function(ma){var na=q.toScreenPoint(la.map.extent,la.map.width,la.map.height,ma);return na},this.startUp()},ea=new function aa(){var ha=$(".val-holder-num-of-fires"),ia=$(".val-holder-smoke-layer-time"),ja=$(".fire-name-search-input"),ka=$(".square-reference-box");this.wildfireGrids=null,this.wildfireTimeline=null,this.fireNameDropdownMenu=null,this.fireDataOberver=null,this.fireSummaryInfoVisibilityOberver=null,this.init=function(){this.wildfireGrids=new ma("wildfire-grid-container"),this.wildfireTimeline=new la("wildfire-timeline-container"),this.fireNameDropdownMenu=new na("fire-name-dropdown-menu"),this.initFireDataObserser(),this.initFireSummaryInfoVisibilityOberver()},this.initFireDataObserser=function(){this.fireDataOberver=new ba,this.fireDataOberver.subscribe(this.wildfireGrids.populate),this.fireDataOberver.subscribe(this.wildfireTimeline.populate),this.fireDataOberver.subscribe(this.updateNumOfFiresVal)},this.populateWildfires=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];this.fireDataOberver.notify(pa)},this.updateNumOfFiresVal=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];ha.text(pa.length)},this.updateSmokeLayerTimeVal=function(pa){var qa=Number.isInteger(pa)?" (+"+pa+" hr)":"";ia.text(qa)},this.initFireSummaryInfoVisibilityOberver=function(){this.fireSummaryInfoVisibilityOberver=new ba,this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireGrids.toggle),this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireTimeline.toggle)},this.toggleFireSummaryInfo=function(pa){this.fireSummaryInfoVisibilityOberver.notify(pa)},this.setFilterLabel=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];pa.forEach(function(qa,ra){var sa=fa(+qa[1]),ta=$(".filter-wrap[data-filter-index=\""+ra+"\"]").find(".filter-label");ta.text(sa)})},this.setSquareReferenceBoxPosition=function(pa){if(!pa)ka.addClass("hide");else{var qa=ka.width()/2;ka.css("top",pa.y-qa),ka.css("left",pa.x-qa),ka.removeClass("hide")}};var la=function(pa){var qa=$("#"+pa),ra=function(){var ta=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],ua={},va=[];return ta.sort(function(wa,xa){return xa.attributes[O]-wa.attributes[O]}),ta.forEach(function(wa){var xa=wa.attributes[O];ua[xa]?ua[xa].fires.push(wa):(ua[xa]={startDate:xa,fires:[wa],isFirstItemInMonth:!1},va.push(xa))}),ta=va.map(function(wa,xa){var ya=va[xa-1],za=sa(wa,ya);return za&&(ua[wa].isFirstItemInMonth=!0),ua[wa]}),ta},sa=function(ta,ua){return ta=new Date(ta),ua=new Date(ua),ta&&ua&&ta.getMonth()!==ua.getMonth()};this.toggle=function(ta){ta===pa?qa.removeClass("hide"):qa.addClass("hide")},this.populate=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];ta=ra(ta);var ua=ta.map(function(va){var xa=moment(va.startDate).format("MMM Do"),ya=moment(va.startDate).format("MMMM"),Aa=va.fires.map(function(Ca){var Da=Ca.attributes[M],Ea=Ca.attributes[N],Fa=Ca.attributes[L],Ga=ca.getRendererBreakIndex(Fa),Ha=Ca.attributes[T],Ia="\n                                <div class='trailer-1 fire-info'>\n                                    <div class='inline-block font-size--3 padding-left-half margin-right-half'><span class='cursor-pointer js-show-info-window js-zoom-to-fire' data-fire-id=\""+Ha+"\"><strong>"+E(Ea)+" Fire</strong>  - "+Da+"% contained</span></div>\n                                    <div class=\"legend-icon legend-class-"+Ga+"\"></div>\n                                </div>\n                            ";return Ia}).join(""),Ba="\n                            "+(va.isFirstItemInMonth?"\n                            <div class='timeline-month-title text-center'>\n                                <div class='padding-leader-quarter padding-trailer-quarter '>\n                                    <span class'avenir-bold'>"+ya+"</span>\n                                </div>\n                            </div>\n                        ":"")+"\n                            <div class='timeline-item'>\n                                <div class='date-info font-size--2'>"+xa+"</div>\n                                <div class='fire-info-wrap text-right'>\n                                    "+Aa+"\n                                </div>\n                            </div>\n                        ";return Ba}).join("");qa.html(ua)}},ma=function(pa){var qa=$("#"+pa);this.toggle=function(ra){ra===pa?qa.removeClass("hide"):qa.addClass("hide")},this.populate=function(){var ra=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],sa=ra.map(function(ta){var ua=ta.attributes[M],va=ta.attributes[N],wa=ta.attributes[L],xa=ca.getRendererBreakIndex(wa),ya=ta.attributes[T];return"\n                            <div class=\"js-show-info-window block trailer-half js-zoom-to-fire\" data-fire-id=\""+ya+"\">\n                                <div class=\"legend-icon legend-class-"+xa+"\">\n                                    <div class='bottom-pct-indicator'>\n                                        <div class='highlight-bar' style=\"width: "+ua+"%;\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        "}).join("");qa.html(sa)}},na=function(pa){var sa=this,qa=$("#"+pa),ra=qa.parent();this.populate=function(ta){ta=ta||da.getListOfFires(!0);var ua=ta.map(function(va){return"<div class='suggestion-item js-set-suggested-item' data-fire-name=\""+va+"\"><span class='font-size--2'>"+va+"</span></div>"}).join("");qa.html(ua)},this.getCountOfDropdownMenuItems=function(){return qa.children().length},this.show=function(){qa.removeClass("hide"),sa.toggleIsDropdownVisible(!0)},this.hide=function(){qa.addClass("hide"),sa.toggleIsDropdownVisible(!1)},this.toggleDropdownMenu=function(){qa.toggleClass("hide");var ta=!qa.hasClass("hide"),ua=!!sa.getCountOfDropdownMenuItems();ta&&!ua&&sa.populate(),sa.toggleIsDropdownVisible(ta)},this.setSelectedItem=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";ra.find(".fire-name-search-input").val(ta);sa.toggleIsSearchInputFilled(!!ta),sa.hide(),ca.setName(ta),da.searchWildfire()},this.toggleIsDropdownVisible=function(ta){ta?ra.addClass("is-dropdown-menu-visible"):ra.removeClass("is-dropdown-menu-visible")},this.toggleIsSearchInputFilled=function(){var ta=0<arguments.length&&arguments[0]!==void 0&&arguments[0];ta?ra.addClass("is-search-input-filled"):ra.removeClass("is-search-input-filled")}},oa=function(){var pa=$("body");pa.on("click",".js-zoom-to-fire",function(){var qa=$(this).attr("data-fire-id");da.zoomToFire(qa)}),pa.on("mouseenter",".js-show-info-window",function(){var qa=$(this).attr("data-fire-id");da.showInfoWindow(qa)}),pa.on("mouseleave",".js-show-info-window",function(){da.hideInforWindow()}),pa.on("click",".js-close-info-window",function(){da.hideInforWindow()}),pa.on("click",".js-toggle-fire-summary-info-container",function(){var qa=$(this),ra=qa.attr("data-target-container");qa.siblings().removeClass("is-active"),qa.addClass("is-active"),ea.toggleFireSummaryInfo(ra)}),pa.on("click",".toggle-suggestion-list-btn",function(){ea.fireNameDropdownMenu.toggleDropdownMenu()}),pa.on("click",".js-set-suggested-item",function(){var qa=$(this).attr("data-fire-name");ea.fireNameDropdownMenu.setSelectedItem(qa)}),pa.on("click",".js-clear-suggested-item",function(){ea.fireNameDropdownMenu.setSelectedItem(null),ea.fireNameDropdownMenu.populate()}),ja.on("keyup",function(){var qa=$(this).val(),ra=da.getMatchedFireNames(qa);ea.fireNameDropdownMenu.populate(ra),qa?ea.fireNameDropdownMenu.toggleIsSearchInputFilled(!0):ea.fireNameDropdownMenu.toggleIsSearchInputFilled(!1),ra.length?ea.fireNameDropdownMenu.show():ea.fireNameDropdownMenu.hide()}),pa.on("click",".js-toggle-smoke-layer",function(){$(".smoke-layer-toggle-btn").toggleClass("checked"),da.toggleSmokeLayer()})}();this.init()},fa=function(ha,ia){if(null===ha)return null;if(0===ha)return"0";ia=!ia||0>ia?0:ia,ia=1e4<ha?0:1;var ja=ha.toPrecision(2).split("e"),ka=1===ja.length?0:Math.floor(Math.min(ja[1].slice(1),14)/3),la=1>ka?ha.toFixed(0+ia):(ha/Math.pow(10,3*ka)).toFixed(ia),ma=0>la?la:Math.abs(la),na=ma+["","K","M","B","T"][ka];return na},ga=function(ha){return ha.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),console.log("Love the app? The source code is available on GitHub:","https://github.com/vannizhang/wildfire-viz-app");