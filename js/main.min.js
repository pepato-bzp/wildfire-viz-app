"use strict";require(["esri/arcgis/utils","esri/request","esri/arcgis/OAuthInfo","esri/arcgis/Portal","esri/IdentityManager","esri/geometry/Point","esri/geometry/Multipoint","esri/geometry/Extent","esri/SpatialReference","esri/geometry/screenUtils","esri/tasks/IdentifyTask","esri/tasks/IdentifyParameters","esri/layers/LayerDrawingOptions","esri/renderers/SimpleRenderer","esri/renderers/ClassBreaksRenderer","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/Color","esri/TimeExtent","dojo/_base/connect","dojo/domReady!"],function(g,h,j,l,m,n,o,p,q,r,t,u,v,w,y,z,A,B,C,D,E){$(document).ready(function(){"use strict";function F(oa){return oa.split(" ").map(function(pa){return pa=pa.toLowerCase(),pa.charAt(0).toUpperCase()+pa.slice(1)}).join(" ")}function G(oa,pa){var ra=window.location.href.split("#")[0];ja.setShareMapViewUrlInputVal(ra+("#"+oa+"="+pa))}function H(){var oa=window.location.hash?window.location.hash.substr(1):null,pa=oa?oa.split("&"):[],qa={};return pa.forEach(function(ra){ra=ra.split("=");var sa=ra[0],ta=ra[1];qa[sa]=ta}),qa}var J="https://utility.arcgis.com/usrsvcs/servers/141efcbd82fd4c129f5b784c2bc85229/rest/services/LiveFeeds/Wildfire_Activity/MapServer",K=J+"/0/query",N="Active_Fire_Report",O=2,P="AREA_",Q="PER_CONT",R="FIRE_NAME",S="START_DATE",T="START_DATE_FORMATTED",X="INTERNALID",ba={"default":[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:15,width:15},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyB17.png",type:"picturemarkersymbol",height:55,width:55}],background:[{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:25,width:25},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:35,width:35},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:45,width:45},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:55,width:55},{url:"https://static.arcgis.com/images/Symbols/Firefly/FireflyC1.png",type:"picturemarkersymbol",height:65,width:65}]},ca={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},ga=function(){var oa=this;this.observers=[],this.subscribe=function(pa){oa.observers.push(pa)},this.unsubscribe=function(pa){oa.observers=oa.observers.filter(function(qa){return qa!==pa})},this.notify=function(pa){oa.observers.forEach(function(qa){return qa(pa)})}},ha=new function da(){var oa=this;this.name="",this.extent=null,this.isInactiveFiresVisible=!1,this.affectedAreaRendererBreaks=[],this.setName=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";oa.name=pa},this.setExtent=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;oa.extent=pa},this.setIsInactiveFiresVisible=function(){var pa=0<arguments.length&&arguments[0]!==void 0&&arguments[0];oa.isInactiveFiresVisible=pa},this.setAffectedAreaRendererBreaks=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];oa.affectedAreaRendererBreaks=pa.map(function(qa,ra){return 0===ra&&(qa[0]=0),{breakInfo:qa,isVisible:!0}})},this.setAffectedAreaRendererVisibilityByIndex=function(){var pa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:-1,qa=arguments[1];-1!==pa&&(oa.affectedAreaRendererBreaks[pa].isVisible=qa)},this.getAffectedAreaRendererBreaks=function(){return oa.affectedAreaRendererBreaks},this.getWhereClause=function(){var qa=[Q+" < 100"],ra=oa.affectedAreaRendererBreaks.filter(function(va){return!va.isVisible}).length;if(ra){var sa=oa.affectedAreaRendererBreaks.filter(function(va){return va.isVisible}),ta=0<sa.length?sa.map(function(va){var xa=va.breakInfo[0],ya=va.breakInfo[1];return"( "+P+" > "+xa+" AND "+P+" <= "+ya+" )"}).join(" OR "):P+" = -1 ";qa.push(ta)}if(oa.name){var ua=R+" = '"+oa.name+"'";qa.push(ua)}return qa=qa.map(function(va){return"("+va+")"}),qa.join(" AND ")},this.getQueryParams=function(){var pa=0<arguments.length&&arguments[0]!==void 0&&arguments[0],qa=oa.getWhereClause(),ra={f:"json",outFields:"*",where:qa,returnGeometry:pa};if(oa.extent){var sa=JSON.stringify(oa.extent.toJson());ra.geometry=sa,ra.geometryType="esriGeometryEnvelope"}return ra},this.getRendererBreakIndex=function(pa){pa=+pa;var qa=-1;return oa.affectedAreaRendererBreaks.forEach(function(ra,sa){var ta=ra.breakInfo[1],ua=ra.breakInfo[0];pa>ua&&pa<=ta&&(qa=sa)}),qa}},ia=new function ea(){var sa=this;this.map=null,this.identifyTask=null,this.identifyParams=null,this.operationalLayers=[],this.allWildfires=[],this.allWildfiresLookupTable={},this.allWildfiresPerimeterLookupTable={},this.wildfireClassBreakRendererInfo=null,this.smokeLayerTimeInfo=null;var oa=null,pa=null,qa=null;this.startUp=function(){var ta=this;this.generateClassBreakRendererInfo(P,function(ua){ua.error||ta.setWildfireClassBreakRendererInfo(ua),ta._initWebMapByID("108e2e8b36ef47abb3942b00e8d69128")})},this.setMap=function(ta){this.map=ta},this.setSmokeLayerTimeInfo=function(ta){this.smokeLayerTimeInfo=ta},this.setAllWildfires=function(ta){this.allWildfires=ta.map(function(ua){var va=moment(ua.attributes[S]).format("MMMM Do, YYYY");return ua.attributes[T]=va,ua}),this.setAllWildfiresLookupTable()},this.setAllWildfiresLookupTable=function(){var ua={};this.allWildfires.forEach(function(va){var wa=va.attributes[X];ua[wa]=va}),this.allWildfiresLookupTable=ua},this.setAllWildfiresPerimeterLookupTable=function(ta){var ua=this;ta.forEach(function(va){var wa=va.attributes.FIRE_NAME.toLowerCase();ua.allWildfiresPerimeterLookupTable[wa]=va.attributes})},this.getFirePerimeterDataByName=function(ta){return ta=ta.toLowerCase(),this.allWildfiresPerimeterLookupTable[ta]},this.getFireDataByID=function(ta){return this.allWildfiresLookupTable[ta]},this.setOperationalLayers=function(ta){var ua=this._getWebMapOperationalLayers(ta),va=ua.filter(function(xa){return-1!==xa.title.indexOf("Active_Fire")}),wa=va[0].layerObject.layerDrawingOptions[0].renderer.breaks;this.operationalLayers=ua,ha.setAffectedAreaRendererBreaks(wa),ja.setFilterLabel(wa)},this._initWebMapByID=function(ta){var ua=this;g.createMap(ta,"mapDiv").then(function(va){var wa=va.map;E.disconnect(va.clickEventHandle),ua.setMap(wa),ua.setMapEeventHandlers(wa),ua.setIdentifyTaskAndParams(wa),ua.setOperationalLayers(va),ua.mapOnReadyHandler()})},this.mapOnReadyHandler=function(){var va=this,ta=ha.getQueryParams(!0),ua=H();this._queryWildfireData(K,ta,function(wa){va.setAllWildfires(wa),ua.ext?va.zoomToExtFromHash(ua.ext):va.zoomToExtentOfAllFires()}),this._queryWildfireData(J+"/2/query",{f:"json",where:"1=1",outFields:"*",returnGeometry:!1},function(wa){va.setAllWildfiresPerimeterLookupTable(wa)})},this.searchWildfire=function(ta){var wa=this,ua=ha.getQueryParams();this._queryWildfireData(K,ua,function va(xa){var ya=wa.sortFiresByFieldName(xa,P);ja.populateWildfires(ya),ta||wa._setLayerDefinitionsForWildfireLayer(ua.where,ya)})},this.sortFiresByFieldName=function(ta,ua){var va=ta;return va.sort(function(wa,xa){return+xa.attributes[ua]-+wa.attributes[ua]}),va},this.setWildfireClassBreakRendererInfo=function(ta){this.wildfireClassBreakRendererInfo=ta},this.getListOfFires=function(ta){var ua=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",va=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",wa=this.allWildfires;return ua&&(wa=wa.filter(function(xa){return xa.attributes[ua]===va})),ta&&(wa=wa.map(function(xa){return xa.attributes[R]})),wa},this.getMatchedFireNames=function(){var ta=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",ua=sa.getListOfFires(!0),va=new RegExp("^"+ta+".*$","i"),wa=[];return 2<=ta.length&&(wa=ua.filter(function(xa){return xa.match(va)}).splice(0,5)),wa},this.getFireIdByName=function(ta){var ua=this.getListOfFires(!1,R,ta)[0];return ua?ua.attributes[X]:""},this.showInfoWindow=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",ua=this.getFireDataByID(ta),va=this.getFeatureGeometryInWgs84(ua),wa=this.convertGeomToScreenPoint(va),xa=ua.attributes["STATE"],ya=ca[xa]?ca[xa]:xa,za=+ua.attributes["LATITUDE"].toFixed(2),Aa=+ua.attributes["LONGITUDE"].toFixed(2),Ba=ua.attributes[R].toLowerCase()+" fire",Fa=this.getFirePerimeterDataByName(ua.attributes[R]),Ga=Fa?Fa["LOAD_DATE"]:null,Ha=Ga?ma(Ga):null,Ia="\n                    <div class='customized-popup-header'>\n                        <span class='font-size--3'>Start Date: "+ua.attributes[T]+"</span>\n                        <span class='js-close-info-window icon-ui-close avenir-bold cursor-pointer font-size--3 right'></span>\n                    </div>\n                    <div class='leader-quarter trailer-quarter'>\n                        <p class='trailer-quarter'> \n                            The "+ua.attributes[R]+" fire in "+ya+" is estimated to be "+la(ua.attributes[P])+" acres and <strong>"+ua.attributes[Q]+"%</strong> contained.\n                        </p>\n                        "+(Ha?"<p class=\"trailer-quarter avenir-italic font-size--4\">Perimeter updated "+Ha+" ago.</p>":"")+"\n                        <hr>\n                        <div class='info-window-links'>\n                            <a href='"+("https://news.google.com/search?q="+Ba)+"' target='_blank' class=''>News</a>\n                            <a href='"+("https://twitter.com/search?q="+Ba)+"' target='_blank' class='margin-left-half'>Twitter</a>\n                            <a href='"+("https://www.facebook.com/search/top/?q="+Ba)+"' target='_blank' class='margin-left-half'>Facebook</a>\n                        </div>\n                    <div>\n                ";this.map.infoWindow.setContent(Ia),this.map.infoWindow.show(va),ja.setSquareReferenceBoxPosition(wa)},this.hideInforWindow=function(){this.map.infoWindow.hide(),ja.setSquareReferenceBoxPosition(null)},this.zoomToFire=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",ua=this.getFireDataByID(ta),va=this.getFeatureGeometryInWgs84(ua);this.map.centerAndZoom(va,12)},this._queryWildfireData=function(ta,ua,va){var ya=h({url:ta,content:ua,handleAs:"json",callbackParamName:"callback"});ya.then(function(za){va(za.features)},function(za){console.log("Error: ",za.message)})},this.getDefExpForFirePerimeterLayer=function(){var ta=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],ua=ta.length?ta.map(function(va){var wa=va.attributes[R].replace("'"," ");return R+" = '"+wa+"'"}).join(" OR "):R+" = ''";return ua},this._setLayerDefinitionsForWildfireLayer=function(ta,ua){var wa=this,va=[ta];this.operationalLayers.forEach(function(xa){if(-1!==xa.id.indexOf("Wildfire")){if(xa.title===N){var ya=wa.getDefExpForFirePerimeterLayer(ua);va[O]=ya}xa.layerObject.setLayerDefinitions(va)}})},this._getWebMapOperationalLayers=function(ta){var va=this,ua=ta.itemInfo.itemData.operationalLayers.filter(function(wa){return"ArcGISMapServiceLayer"===wa.layerType});return ua.forEach(function(wa){-1!==wa.title.indexOf("Active_Fire")&&va.setLayerDrawingOptions(wa),-1!==wa.title.indexOf("SmokeForecast")&&(va.setCssStyleForSmokeLayerContainer(wa.id),va.setSmokeLayerTimeInfo(wa.layerObject.timeInfo))}),ua},this.setCssStyleForSmokeLayerContainer=function(ta){var ua=$("#mapDiv_"+ta);ua.css("filter","invert(100%) blur(5px) saturate(.4)")},this.setMapTimeExtent=function(ta,ua){ta=ta?new Date(ta):this.smokeLayerTimeInfo.timeExtent.startTime,ua=ua?new Date(ua):ta;var va=new D;va.startTime=ta,va.endTime=ua,this.map.setTimeExtent(va)},this.toggleSmokeLayer=function(){var ta=this.operationalLayers.filter(function(va){return-1!==va.title.indexOf("SmokeForecast")})[0],ua=!ta.layerObject.visible;ua?(this.animateSmokeLayer(),ta.layerObject.show()):(clearInterval(oa),ta.layerObject.hide(),ja.updateSmokeLayerTimeVal(null))},this.animateSmokeLayer=function(){var ta=this;oa=setInterval(function(){pa?(pa=new Date(pa),pa=pa.setHours(pa.getHours()+1),pa>qa&&(pa=ta.smokeLayerTimeInfo.timeExtent.startTime)):(pa=ta.smokeLayerTimeInfo.timeExtent.startTime,qa=new Date(pa),qa=qa.setHours(pa.getHours()+24));var ua=Math.abs(pa-ta.smokeLayerTimeInfo.timeExtent.startTime.getTime())/3.6e6;ta.setMapTimeExtent(pa),ja.updateSmokeLayerTimeVal(ua)},750)},this.getWildfireLayerRendererByTitle=function(ta){var ua=null;if(this.wildfireClassBreakRendererInfo){var va=JSON.parse(JSON.stringify(this.wildfireClassBreakRendererInfo)),wa=ta===N?ba["default"]:ba.background;va.classBreakInfos=va.classBreakInfos.map(function(xa,ya){var za=new z(wa[ya]);return xa.symbol=za.toJson(),xa}),ua=new y(va)}return ua},this.getRendererForFirePerimeter=function(){var ta=new A(A.STYLE_SOLID,new B(B.STYLE_SOLID,new C([103,0,67,0.9]),1),new C([103,0,67,0.4])),ua=new w(ta);return ua},this.setLayerDrawingOptions=function(ta){var ua=ta.layerObject,va=ta.title,wa=va===N?.75:.5,xa=[],ya=this.getLayerDrawingOption(va);if(xa[0]=ya,va===N){var za=this.getLayerDrawingOption(va,O);xa[O]=za}ua.setLayerDrawingOptions(xa),ua.setOpacity(wa)},this.getLayerDrawingOption=function(ta){var ua=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,va=new v;return va.renderer=0===ua?sa.getWildfireLayerRendererByTitle(ta):sa.getRendererForFirePerimeter(),va},this.zoomToExtFromHash=function(ta){var ua=ta.split(","),va=new p({xmin:+ua[0],ymin:+ua[1],xmax:+ua[2],ymax:+ua[3],spatialReference:{wkid:102100}});this.map.setExtent(va)},this.zoomToExtentOfAllFires=function(){var ta=this.allWildfires.map(function(va){return[va.geometry.x,va.geometry.y]}),ua=new o(new q({wkid:102100}));ua.points=ta,this.map.setExtent(ua.getExtent(),!0)},this.execIdentifyTask=function(ta){var ua=this.identifyTaskOnSuccessHandler;this.identifyParams.geometry=ta,this.identifyParams.mapExtent=this.map.extent,this.identifyTask.execute(this.identifyParams,ua)},this.identifyTaskOnSuccessHandler=function(ta){if(ta.length){var ua=ta[0].value,va=sa.getFireIdByName(ua);sa.showInfoWindow(va)}},this.setIdentifyTaskAndParams=function(ta){var ua=new u;ua.tolerance=8,ua.returnGeometry=!1,ua.layerIds=[0],ua.width=ta.width,ua.height=ta.height,this.identifyParams=ua,this.identifyTask=new t(J)},this.setMapEeventHandlers=function(ta){var ua=this;ta.on("click",function(va){ua.hideInforWindow(),ua.execIdentifyTask(va.mapPoint)}),ta.on("extent-change",function(va){var wa=!!(12<=ta.getZoom());ua.hideInforWindow(),ha.setExtent(va.extent),ua.searchWildfire(wa),ua.addMapExtToHash(ta)})},this.addMapExtToHash=function(ta){var ua=ta.extent,va=ua.xmin+","+ua.ymin+","+ua.xmax+","+ua.ymax;G("ext",va)},this.generateClassBreakRendererInfo=function(ta,ua){var xa={classificationDef:JSON.stringify({type:"classBreaksDef",classificationField:ta,classificationMethod:"esriClassifyNaturalBreaks",breakCount:5}),layer:JSON.stringify({source:{type:"mapLayer",mapLayerId:0}}),f:"json",where:""},ya=h({url:J+"/dynamicLayer/generateRenderer",content:xa,handleAs:"json"});ya.then(function(za){ua(za)},function(za){console.log("Error: ",za.message),ua({error:za.message})})},this.getFeatureGeometryInWgs84=function(ta){return new n({x:ta.attributes.LONGITUDE,y:ta.attributes.LATITUDE,spatialReference:{wkid:4326}})},this.convertGeomToScreenPoint=function(ta){var ua=r.toScreenPoint(sa.map.extent,sa.map.width,sa.map.height,ta);return ua},this.startUp()},ja=new function fa(){var oa=$(".val-holder-num-of-fires"),pa=$(".val-holder-smoke-layer-time"),qa=$(".fire-name-search-input"),ra=$(".square-reference-box"),sa=$(".share-map-view-url-input");this.wildfireGrids=null,this.wildfireTimeline=null,this.fireNameDropdownMenu=null,this.fireDataOberver=null,this.fireSummaryInfoVisibilityOberver=null,this.init=function(){this.wildfireGrids=new ua("wildfire-grid-container"),this.wildfireTimeline=new ta("wildfire-timeline-container"),this.fireNameDropdownMenu=new va("fire-name-dropdown-menu"),this.initFireDataObserser(),this.initFireSummaryInfoVisibilityOberver()},this.initFireDataObserser=function(){this.fireDataOberver=new ga,this.fireDataOberver.subscribe(this.wildfireGrids.populate),this.fireDataOberver.subscribe(this.wildfireTimeline.populate),this.fireDataOberver.subscribe(this.updateNumOfFiresVal)},this.populateWildfires=function(){var xa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];this.fireDataOberver.notify(xa)},this.updateNumOfFiresVal=function(){var xa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];oa.text(xa.length)},this.updateSmokeLayerTimeVal=function(xa){var ya=Number.isInteger(xa)?" (+"+xa+" hr)":"";pa.text(ya)},this.initFireSummaryInfoVisibilityOberver=function(){this.fireSummaryInfoVisibilityOberver=new ga,this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireGrids.toggle),this.fireSummaryInfoVisibilityOberver.subscribe(this.wildfireTimeline.toggle)},this.toggleFireSummaryInfo=function(xa){this.fireSummaryInfoVisibilityOberver.notify(xa)},this.setFilterLabel=function(){var xa=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];xa.forEach(function(ya,za){var Aa=ka(+ya[1]),Ba=$(".filter-wrap[data-filter-index=\""+za+"\"]").find(".filter-label");Ba.text(Aa)})},this.setSquareReferenceBoxPosition=function(xa){if(!xa)ra.addClass("hide");else{var ya=ra.width()/2;ra.css("top",xa.y-ya),ra.css("left",xa.x-ya),ra.removeClass("hide")}},this.setShareMapViewUrlInputVal=function(xa){sa.val(xa)};var ta=function(xa){var ya=$("#"+xa),za=function(){var Ba=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],Ca={},Da=[];return Ba.sort(function(Ea,Fa){return Fa.attributes[S]-Ea.attributes[S]}),Ba.forEach(function(Ea){var Fa=Ea.attributes[S];Ca[Fa]?Ca[Fa].fires.push(Ea):(Ca[Fa]={startDate:Fa,fires:[Ea],isFirstItemInMonth:!1},Da.push(Fa))}),Ba=Da.map(function(Ea,Fa){var Ga=Da[Fa-1],Ha=Aa(Ea,Ga);return Ha&&(Ca[Ea].isFirstItemInMonth=!0),Ca[Ea]}),Ba},Aa=function(Ba,Ca){return Ba=new Date(Ba),Ca=new Date(Ca),Ba&&Ca&&Ba.getMonth()!==Ca.getMonth()};this.toggle=function(Ba){Ba===xa?ya.removeClass("hide"):ya.addClass("hide")},this.populate=function(){var Ba=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];Ba=za(Ba);var Ca=Ba.map(function(Da){var Fa=moment(Da.startDate).format("MMM Do"),Ga=moment(Da.startDate).format("MMMM"),Ia=Da.fires.map(function(Ka){var La=Ka.attributes[Q],Ma=Ka.attributes[R],Na=Ka.attributes[P],Oa=ha.getRendererBreakIndex(Na),Pa=Ka.attributes[X],Qa="\n                                <div class='trailer-1 fire-info'>\n                                    <div class='inline-block font-size--3 padding-left-half margin-right-half'><span class='cursor-pointer js-show-info-window js-zoom-to-fire' data-fire-id=\""+Pa+"\"><strong>"+F(Ma)+" Fire</strong>  - "+La+"% contained</span></div>\n                                    <div class=\"legend-icon legend-class-"+Oa+"\"></div>\n                                </div>\n                            ";return Qa}).join(""),Ja="\n                            "+(Da.isFirstItemInMonth?"\n                            <div class='timeline-month-title text-center'>\n                                <div class='padding-leader-quarter padding-trailer-quarter '>\n                                    <span class'avenir-bold'>"+Ga+"</span>\n                                </div>\n                            </div>\n                        ":"")+"\n                            <div class='timeline-item'>\n                                <div class='date-info font-size--2'>"+Fa+"</div>\n                                <div class='fire-info-wrap text-right'>\n                                    "+Ia+"\n                                </div>\n                            </div>\n                        ";return Ja}).join("");ya.html(Ca)}},ua=function(xa){var ya=$("#"+xa);this.toggle=function(za){za===xa?ya.removeClass("hide"):ya.addClass("hide")},this.populate=function(){var za=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],Aa=za.map(function(Ba){var Ca=Ba.attributes[Q],Da=Ba.attributes[R],Ea=Ba.attributes[P],Fa=ha.getRendererBreakIndex(Ea),Ga=Ba.attributes[X];return"\n                            <div class=\"js-show-info-window block trailer-half js-zoom-to-fire\" data-fire-id=\""+Ga+"\">\n                                <div class=\"legend-icon legend-class-"+Fa+"\">\n                                    <div class='bottom-pct-indicator'>\n                                        <div class='highlight-bar' style=\"width: "+Ca+"%;\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        "}).join("");ya.html(Aa)}},va=function(xa){var Aa=this,ya=$("#"+xa),za=ya.parent();this.populate=function(Ba){Ba=Ba||ia.getListOfFires(!0);var Ca=Ba.map(function(Da){return"<div class='suggestion-item js-set-suggested-item' data-fire-name=\""+Da+"\"><span class='font-size--2'>"+Da+"</span></div>"}).join("");ya.html(Ca)},this.getCountOfDropdownMenuItems=function(){return ya.children().length},this.show=function(){ya.removeClass("hide"),Aa.toggleIsDropdownVisible(!0)},this.hide=function(){ya.addClass("hide"),Aa.toggleIsDropdownVisible(!1)},this.toggleDropdownMenu=function(){ya.toggleClass("hide");var Ba=!ya.hasClass("hide"),Ca=!!Aa.getCountOfDropdownMenuItems();Ba&&!Ca&&Aa.populate(),Aa.toggleIsDropdownVisible(Ba)},this.setSelectedItem=function(){var Ba=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";za.find(".fire-name-search-input").val(Ba);Aa.toggleIsSearchInputFilled(!!Ba),Aa.hide(),ha.setName(Ba),ia.searchWildfire()},this.toggleIsDropdownVisible=function(Ba){Ba?za.addClass("is-dropdown-menu-visible"):za.removeClass("is-dropdown-menu-visible")},this.toggleIsSearchInputFilled=function(){var Ba=0<arguments.length&&arguments[0]!==void 0&&arguments[0];Ba?za.addClass("is-search-input-filled"):za.removeClass("is-search-input-filled")}},wa=function(){var xa=$("body");xa.on("click",".js-zoom-to-fire",function(){var ya=$(this).attr("data-fire-id");ia.zoomToFire(ya)}),xa.on("mouseenter",".js-show-info-window",function(){var ya=$(this).attr("data-fire-id");ia.showInfoWindow(ya)}),xa.on("mouseleave",".js-show-info-window",function(){ia.hideInforWindow()}),xa.on("click",".js-close-info-window",function(){ia.hideInforWindow()}),xa.on("click",".js-toggle-fire-summary-info-container",function(){var ya=$(this),za=ya.attr("data-target-container");ya.siblings().removeClass("is-active"),ya.addClass("is-active"),ja.toggleFireSummaryInfo(za)}),xa.on("click",".toggle-suggestion-list-btn",function(){ja.fireNameDropdownMenu.toggleDropdownMenu()}),xa.on("click",".js-set-suggested-item",function(){var ya=$(this).attr("data-fire-name");ja.fireNameDropdownMenu.setSelectedItem(ya)}),xa.on("click",".js-clear-suggested-item",function(){ja.fireNameDropdownMenu.setSelectedItem(null),ja.fireNameDropdownMenu.populate()}),qa.on("keyup",function(){var ya=$(this).val(),za=ia.getMatchedFireNames(ya);ja.fireNameDropdownMenu.populate(za),ya?ja.fireNameDropdownMenu.toggleIsSearchInputFilled(!0):ja.fireNameDropdownMenu.toggleIsSearchInputFilled(!1),za.length?ja.fireNameDropdownMenu.show():ja.fireNameDropdownMenu.hide()}),xa.on("click",".js-toggle-smoke-layer",function(){$(".smoke-layer-toggle-btn").toggleClass("checked"),ia.toggleSmokeLayer()}),xa.on("click",".js-copy-share-map-view-url",function(){var ya=document.getElementById("shareViewInput");ya.select(),document.execCommand("copy")})}();this.init()},ka=function(oa,pa){if(null===oa)return null;if(0===oa)return"0";pa=!pa||0>pa?0:pa,pa=1e4<oa?0:1;var qa=oa.toPrecision(2).split("e"),ra=1===qa.length?0:Math.floor(Math.min(qa[1].slice(1),14)/3),sa=1>ra?oa.toFixed(0+pa):(oa/Math.pow(10,3*ra)).toFixed(pa),ta=0>sa?sa:Math.abs(sa),ua=ta+["","K","M","B","T"][ra];return ua},la=function(oa){return oa.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},ma=function(oa){var pa=na(oa),qa="";return qa=24>pa?pa.toFixed(0)+" hours":Math.floor(pa/24)+" days",qa},na=function(oa){oa=new Date(oa).getTime();var pa=new Date().getTime(),qa=Math.abs(oa-pa)/36e5;return qa}})}),console.log("Love the app? The source code is available on GitHub:","https://github.com/vannizhang/wildfire-viz-app");